var io;
var gameSocket;
var rooms = [];
exports.initGame = function(sio,socket){
	io = sio;
	gameSocket = socket;

	
	gameSocket.emit('connected', { message: "You are connected!" });
    // Host Events
    gameSocket.on('hostCreateNewGame', hostCreateNewGame);
    gameSocket.on('playerJoinGame',playerJoinGame);
    gameSocket.on('updatePlayerPlayersServer',updatePlayerPlayersServer);
    gameSocket.on('chatMessage',chatMessage);
}


function hostCreateNewGame(data){

	var gameID =  (Math.random()*100000) | 0 ;
	data.gameID = gameID;
	data.mySocketID = this.id;
	this.emit('newGameCreated',data);
	this.join(gameID.toString());
}
function playerJoinGame(data) {
    var sock = this;
    var room = gameSocket.manager.rooms["/" + data.gameID];
    if( room != undefined ){
        data.mySocketID = sock.id;
        sock.join(data.gameID);
        io.sockets.in(data.gameID).emit('playerJoinedRoom', data);

    } else {

        this.emit('error',{message: "This room does not exist."} );
    }
}
function updatePlayerPlayersServer(data) {
	console.log(data);
   	io.sockets.in(data[0].gameID).emit('updatePlayerPlayers',data);
}
function chatMessage(data) {
	console.log(data);
   	io.sockets.in(data.gameID).emit('newChatMessage',data);
}